# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

This is a blog application built with TanStack Start (full-stack React framework), TanStack Router (file-based routing), and TanStack Query (data fetching). The app uses React 19, Tailwind CSS v4, and Biome for linting/formatting.

## Development Commands

### Package Manager
This project uses `pnpm`. All commands should use `pnpm`, not `npm` or `yarn`.

### Core Commands
- `pnpm install` - Install dependencies
- `pnpm dev` - Start development server on port 3000
- `pnpm build` - Build for production
- `pnpm serve` - Preview production build
- `pnpm test` - Run all tests with Vitest
- `pnpm lint` - Lint code with Biome
- `pnpm format` - Format code with Biome
- `pnpm check` - Run both linting and formatting checks

## Architecture

### Routing (TanStack Router)
- **File-based routing**: Routes are defined as files in `src/routes/`
- **Root route**: `src/routes/__root.tsx` serves as the layout for all routes
- **Route tree**: `src/routeTree.gen.ts` is auto-generated by TanStack Router - do not edit manually
- **Router setup**: `src/router.tsx` creates the router instance and integrates TanStack Query with SSR support
- **Router context**: The router is configured with a custom context (`MyRouterContext`) that includes the QueryClient for React Query integration

### Data Fetching (TanStack Query)
- **Integration layer**: `src/integrations/tanstack-query/` contains Query setup
- **Root provider**: `root-provider.tsx` creates and provides the QueryClient
- **Router integration**: The QueryClient is passed through router context for SSR query support via `setupRouterSsrQueryIntegration`
- Data can be fetched using either:
  - Route `loader` functions (preferred for route-level data)
  - `useQuery` hooks within components

### Styling
- **Tailwind CSS v4**: Uses the new Vite plugin (`@tailwindcss/vite`)
- **Main stylesheet**: `src/styles.css` (excluded from Biome checks)
- **Font**: Google Fonts "Geist" (loaded in root route)

### TypeScript Configuration
- **Path aliases**: `@/*` maps to `./src/*` (configured in both `tsconfig.json` and Vite via `vite-tsconfig-paths`)
- **Strict mode enabled**: All TypeScript strict checks are on
- **Module resolution**: Uses "bundler" mode for modern build tools

### Project Structure
```
src/
├── routes/           # File-based routes (TanStack Router)
│   └── __root.tsx    # Root layout with Header, devtools, and HTML shell
├── components/       # Reusable React components
│   └── layout/       # Layout components (e.g., Header)
├── integrations/     # Third-party integrations setup
│   └── tanstack-query/
├── data/             # Data/constants (demo files can be deleted)
├── router.tsx        # Router configuration and setup
└── routeTree.gen.ts  # Auto-generated route tree (do not edit)
```

## Code Style

### Biome Configuration
- **Formatter**: Uses tabs for indentation (not spaces)
- **Quote style**: Double quotes for JavaScript/TypeScript
- **Auto-organize imports**: Enabled via assist actions
- **Files scoped**: Only files in `src/`, `.vscode/`, `index.html`, and `vite.config.js`
- **Excluded files**: `src/routeTree.gen.ts`, `src/styles.css`

When creating or editing files, ensure:
- Use tabs, not spaces
- Use double quotes for strings
- Biome will auto-organize imports

## Testing
- **Framework**: Vitest with jsdom environment
- **Testing Library**: React Testing Library and DOM Testing Library are available
- No existing test files - tests should be created when needed

## Devtools
The app includes devtools for development (configured in `__root.tsx`):
- TanStack Router Devtools
- TanStack Query Devtools
- TanStack React Devtools (unified panel, bottom-right)

## Important Notes
- **Demo files**: Files prefixed with `demo` (e.g., `demo.punk-songs.ts`) can be safely deleted
- **Generated files**: Never manually edit `src/routeTree.gen.ts` - it's auto-generated by TanStack Router
- **New routes**: Simply create a new file in `src/routes/` and TanStack Router will auto-generate the route configuration
